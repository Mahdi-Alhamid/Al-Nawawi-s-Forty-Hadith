<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>مجموعة الأربعين</title>
    
    <style>
        :root {
            --bg: #f7f7fb;
            --card: #fff;
            --accent: #0a8a45;
            --muted: #666;
            --quote: #0a8a45;
            --paren: #0a8a45;
        }

        body {
            font-family: "Noto Naskh Arabic", "Segoe UI", Tahoma, Arial;
            margin: 0;
            background: var(--bg);
            color: #111;
            padding: 20px;
        }

        .container {
            max-width: 1100px;
            margin: 20px auto;
            padding: 16px
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px
        }

        h1 {
            font-size: 20px;
            margin: 0
        }

        p.lead {
            margin: 6px 0 0;
            color: var(--muted)
        }

        .layout {
            display: grid;
            grid-template-columns: 340px 1fr;
            gap: 16px
        }

        @media (max-width:720px) {
            .layout {
                grid-template-columns: 1fr
            }
        }

        .sidebar {
            background: var(--card);
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(10, 10, 30, 0.06)
        }

        .search {
            display: flex;
            margin-bottom: 8px
        }

        .search input {
            flex: 1;
            padding: 8px;
            border: 1px solid #e6e9ef;
            border-radius: 8px
        }

        .view-toggle {
            display: flex;
            gap: 8px;
            margin-bottom: 10px
        }

        .view-toggle .btn.small {
            padding: 6px 8px;
            font-size: 13px;
            border-radius: 8px;
            border: 1px solid #e6e9ef;
            background: transparent;
            cursor: pointer
        }

        .view-toggle .btn.small.active {
            background: var(--accent);
            color: #fff;
            border-color: var(--accent)
        }

        .hadith-list {
            max-height: 72vh;
            overflow: auto
        }

        .section {
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid #f0f2f7;
            background: #fff
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            cursor: pointer
        }

        .section-header:hover {
            background: #f7fbff
        }

        .section-body {
            padding: 6px 10px;
            border-top: 1px solid #f0f2f7;
            display: none
        }

        .hadith-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            border-radius: 8px;
            margin-bottom: 6px
        }

        .hadith-item button {
            border: 0;
            background: transparent;
            padding: 6px 8px;
            border-radius: 8px;
            text-align: right;
            width: 100%;
            cursor: pointer
        }

        .hadith-item button:hover {
            background: rgba(11, 116, 222, 0.03)
        }

        .num {
            min-width: 36px;
            text-align: center;
            margin-left: 8px;
            background: #f1f6ff;
            color: var(--accent);
            padding: 6px;
            border-radius: 8px
        }

        .content {
            background: var(--card);
            padding: 18px;
            border-radius: 12px;
            box-shadow: 0 6px 18px rgba(10, 10, 30, 0.06);
            min-height: 60vh
        }

        .meta {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 12px
        }

        .meta div {
            background: #f5f7fb;
            padding: 8px;
            border-radius: 8px
        }

        .hadith-text {
            font-size: 20px;
            line-height: 1.7;
            margin-top: 12px;
            white-space: pre-wrap
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-top: 12px
        }

        .btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: 0;
            cursor: pointer
        }

        .btn.primary {
            background: var(--accent);
            color: #fff
        }

        .btn.ghost {
            background: transparent;
            border: 1px solid #e6e9ef
        }

        .note {
            color: var(--muted);
            font-size: 13px;
            margin-top: 8px
        }

        footer {
            margin-top: 16px;
            color: var(--muted);
            font-size: 13px
        }

        .double-quote {
            color: var(--quote);
            font-weight: 600
        }

        .paren {
            color: var(--paren);
            font-weight: 600
        }

        .small-action {
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid #e6e9ef;
            background: transparent;
            cursor: pointer
        }

        .debug {
            font-size: 13px;
            color: #444;
            margin-top: 8px;
            background: #fff;
            padding: 8px;
            border-radius: 8px;
            border: 1px dashed #eee
        }
.ornate-nav{
  --panel-bg: rgba(255,255,255,0.95);   
  --text: #0b1b26;                       
  --muted: #456073;                      
  --accent: #ffb703;                     
  padding: 12px 16px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  background: var(--panel-bg);
  color: var(--text);
  box-shadow: 0 6px 20px rgba(2,6,23,0.08);
  border: 1px solid rgba(7,20,39,0.06);
  max-width: 100%;
  box-sizing: border-box;
}

.ornate-nav * { box-sizing: inherit; }

.ornate-nav .nav-title { display:flex; gap:10px; align-items:center; min-width:0; }
.ornate-nav .nav-title h1 { margin-right: 60px; font-size:1rem; color:var(--text); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

.ornate-nav .nav-links { display:flex; gap:8px; align-items:center; justify-content: center; padding:0; list-style:none; flex-wrap:wrap; }

.ornate-nav .nav-links a,
.ornate-nav .nav-links a:visited,
.ornate-nav .nav-links a:active,
.ornate-nav .nav-links a:focus {
  color: var(--text);
  text-decoration: none;
  background: transparent;
  padding: 8px 12px;
  border-radius: 8px;
  font-weight:600;
  transition: transform .16s, box-shadow .16s, background .12s;
  border: 1px solid transparent;
}

.ornate-nav .nav-links a:hover,
.ornate-nav .nav-links a:focus {
  transform: translateY(-4px);
  box-shadow: 0 10px 22px rgba(2,6,23,0.08);
  background: rgba(7,20,39,0.03);
  outline: none;
}

.ornate-nav .nav-links a.cta {
  background: var(--accent);
  color: #071427;
  box-shadow: none;
  border: 1px solid rgba(0,0,0,0.06);
}

.ornate-nav svg { width:1.05em; height:1.05em; vertical-align:middle; fill: currentColor; stroke: currentColor; }

@media (max-width:700px){
  .ornate-nav { flex-direction: column; align-items: stretch; gap:10px; }
  .ornate-nav .nav-links { width:100%; justify-content: center; }
  .ornate-nav .nav-links a { width: auto; }
}
</style>


</head>

<body>
    <nav class="ornate-nav" role="navigation" aria-label="قائمة الأحاديث الأربعون">
        <div class="nav-top">
            <div class="nav-title">
                <h1>الأحاديث الأربعون النووية</h1>
                <span class="ornament" aria-hidden="true"></span>
            </div>
    
            <ul class="nav-links" role="menubar" class="cta" aria-label="روابط صفحات الحفظ والاختبار">
                <li role="none">
                    <a role="menuitem" href="/index.html" title="انتقل إلى صفحة حفظ الأحاديث" style="background-color: #0a8a45; color: #fff;">
                        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                            <path d="M3 5.5C3 4.7 3.7 4 4.5 4h12c.8 0 1.5.7 1.5 1.5V20l-7-3-7 3V5.5z"
                                stroke="rgba(0,0,0,0.06)" stroke-width="0.8" fill="rgba(255,255,255,0.02)" />
                        </svg>
                        حفظ الأحاديث
                    </a>
                </li>
    
                <li role="none">
                    <a role="menuitem" href="/Q2.html" title="قم باختبار حفظك للأحاديث" >
                        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                            <path d="M9 12l2 2 4-4" stroke="rgba(7,20,39,0.95)" stroke-width="1.6" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <rect x="3" y="3" width="18" height="18" rx="3" stroke="rgba(7,20,39,0.95)" stroke-width="1.2"
                                fill="rgba(255,255,255,0.02)" />
                        </svg>
                        اختبار الحفظ
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container">
        <header>
            <div>
                <h1>موقع الأحاديث - مجموعة الأربعين</h1>
            </div>
        </header>

        <div class="layout">
            <aside class="sidebar">
                <div class="view-toggle">
                    <button id="modeSections" class="btn small">عرض بالأقسام</button>
                    <button id="modeFlat" class="btn small">عرض مرتب (1→40)</button>
                </div>

                <div class="search"><input id="search" placeholder="ابحث برقم أو اسم الحديث..." /></div>

                <div class="hadith-list" id="hadithList" aria-live="polite"></div>

                <div style="margin-top:8px;display:flex;gap:8px">
                    <button class="small-action" id="importBtn">استيراد JSON</button>
                    <button class="small-action" id="exportBtn">تصدير JSON</button>
                    <button class="small-action" id="resetStorageBtn"
                        title="يمسح البيانات المخزنة ويعيد التحميل من المصدر">إعادة تهيئة التخزين</button>
                </div>

                <div class="debug" id="debugStatus">جارٍ التحقق...</div>
            </aside>

            <main class="content" id="content">
                <div id="emptyView">
                    <h2>اختر حديثاً من القائمة</h2>
                </div>

                <div id="hadithView" style="display:none">
                    <h2 id="hadithTitle"></h2>
                    <div class="meta">
                        <div>الرقم: <strong id="hadithNumber"></strong></div>
                        <div>الراوي: <strong id="hadithNarrator"></strong></div>
                        <div>المصدر: <strong id="hadithSource"></strong></div>
                    </div>

                    <div class="hadith-text" id="hadithText" role="article"></div>

                    <div class="controls">
                        <button class="btn ghost" id="clearBtn">مسح العرض</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <input type="file" id="fileInput" accept="application/json" style="display:none" />

    <script>
        const categories = [
            { key: 'bukhari_muslim', title: 'الأحاديث التي أخرجها البخاري ومسلم', items: [1, 3, 4, 5, 6, 8, 9, 13, 14, 15, 26, 37] },
            { key: 'bukhari_only', title: 'الأحاديث التي انفرد بها البخاري', items: [16, 20, 38, 40] },
            { key: 'muslim_only', title: 'الأحاديث التي انفرد بها مسلم', items: [2, 7, 10, 17, 21, 22, 23, 24, 25, 34, 35, 36] },
            { key: 'tirmidhi', title: 'الأحاديث التي رواها الترمذي', items: [18, 19, 29] },
            { key: 'tirmidhi_nasai', title: 'الأحاديث التي رواها الترمذي والنسائي', items: [11] },
            { key: 'tirmidhi_ibnmajah', title: 'الأحاديث التي رواها الترمذي وابن ماجه', items: [12] },
            { key: 'ahmad_darami', title: 'الأحاديث التي رواها الإمام أحمد والدارمي', items: [27] },
            { key: 'tirmidhi_abudawud', title: 'الأحاديث التي رواها الترمذي وأبو داود', items: [28] },
            { key: 'daraqutni', title: 'الأحاديث التي رواها الدارقطني وغيره', items: [30] },
            { key: 'ibn_majah_others', title: 'الأحاديث التي رواها بها ابن ماجه وغيره', items: [31] },
            { key: 'al_bayhaqi', title: 'الأحاديث التي رواها البيهقي وغيره', items: [33] },
            { key: 'ibnmajah_bayhaqi', title: 'الأحاديث التي رواها ابن ماجه والبيهقي', items: [39] }
        ];

        const titles = {
            1: 'الأعمال بالنيات', 2: 'مراتب الدين', 3: 'أركان الإسلام', 4: 'مراحل الخلق', 5: 'النهي عن الابتداع في الدين',
            6: 'البعد عن مواطن الشبهات', 7: 'الدين النصيحة', 8: 'حرمة دم المسلم وماله', 9: 'النهي عن كثرة السؤال والتشدد',
            10: 'سبب إجابة الدعاء', 11: 'اترك ما شككت فيه', 12: 'الاشتغال بما يفيد', 13: 'من كمال الإيمان', 14: 'متى يهدر دم المسلم؟',
            15: 'اكرام الضيف', 16: 'النهي عن الغضب', 17: 'الرفق بالحيوان', 18: 'الخلق الحسن', 19: 'الإيمان بالقضاء والقدر',
            20: 'الحياء من الإيمان', 21: 'الاستقامه بالإسلام', 22: 'الطريق إلى الجنة', 23: 'جوامع الخير', 24: 'من فضل الله على الناس',
            25: 'فضل الذكر', 26: 'كثرة طرق الخير', 27: 'تعريف البر والإثم', 28: 'السمع والطاعة', 29: 'بواب الخير',
            30: 'الوقوف عند حدود الشرع', 31: 'الزهد في الدنيا', 32: 'لا ضرر ولا ضرار', 33: 'البيّنة على المُدَّعي',
            34: 'تغيير المنكر فريضة', 35: 'المسلم أخو المسلم', 36: 'قضاء حوائج المسلمين', 37: 'الترغيب في فعل الحسنات',
            38: 'جزاء معادات الأولياء', 39: 'التجاوز عن الخطأ والنسيان', 40: 'كن في الدنيا كأنك غريب'
        };

        /* ---------- مصفوفة الأحاديث (مصدر) ---------- */

            const hadithData = [
                {
                    number: 1, title: 'الأعمال بالنيات', narrator: 'أَمِيرِ المُؤمِنينَ أَبي حَفْصٍ عُمَرَ بْنِ الخَطَّابِ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَمِيرِ المُؤمِنينَ أَبي حَفْصٍ عُمَرَ بْنِ الخَطَّابِ قَالَ : سَمِعْتُ رَسُولَ اللهِ ﷺ يَقُولُ : " إِنَّمَا الأَعْمَالُ بِالنِّيَّاتِ ، وَإنَّمَا لِكُلِّ امْرِىءٍ مَا نَوَى ، فَمَنْ كَانَتْ هِجْرَتُهُ إِلى اللهِ وَرَسُوله فَهِجْرتُهُ إلى اللهِ وَرَسُوُله ، وَمَنْ كَانَتْ هِجْرَتُهُ لِدُنْيَا يُصِيْبُهَا ، أَو امْرأَةٍ يَنْكِحُهَا ، فَهِجْرَتُهُ إِلى مَا هَاجَرَ إلَيْهِ " رواه إماما المحدثين أبو عبدالله محمد بن إسماعيل بن إبراهيم بن المغيرة بن بَرْدِزْبَهْ البخاري ، وأبو الحسين مسلم بن الحجَّاج ين مسلم القشيري النيسابوري ، في صحيحيهما اللَذين هما أصح الكتب المصنفة .`
                },

                {
                    number: 2, title: 'مراتب الدين', narrator: 'عُمَرَ رضي الله عنه', source: 'رواه مسلم',
                    text: `عَنْ عُمَرَ رَضِيَ اللهُ تَعَالَى عَنْهُ أقَال : بَيْنَمَا نَحْنُ جُلُوْسٌ عِنْدَ رَسُولِ اللهِ ذَاتَ يَوْمٍ إَذْ طَلَعَ عَلَيْناَ رَجُلٌ شَدِيْدُ بَيَاضِ الثّياب شَدِيْدُ سَوَادِ الشَّعْرِ لاَ يُرَى عَلَيهِ أَثَرُ السَّفَرِ وَلاَ يَعْرِفُهُ مِنا أحَدٌ حَتى جَلَسَ إلَى النبِي فَأَسْنَدَ رُكْبَتَيْهِ إلَى رُكْبَتَيْهِ وَوَضَعَ كَفيْهِ عَلَى فَخِذِيْهِ وَقَالَ : يَا مُحَمَّدُ أَخْبِرْنِي عَنِ الإِسْلاَم ، فَقَالَ رَسُولُ اللهِ ﷺ : " الإِسْلاَمُ أَنْ تَشْهَدَ أَنْ لاَ إلَه إلاَّ اللهُ وَأَنَّ مُحَمَّدَاً رَسُولُ الله ، وَتُقِيْمَ الصَّلاَة ، وَتُؤْتِيَ الزَّكَاةَ ، وَتَصُوْمَ رَمَضَانَ ، وَتَحُجَّ البيْتَ إِنِ اِسْتَطَعتَ إِليْهِ سَبِيْلاً " قَالَ: صَدَقْتَ. فَعجِبْنَا لَهُ يَسْأَلُهُ وَيُصَدِّقُهُ، قَالَ: فَأَخْبِرِنيْ عَنِ الإِيْمَانِ، قَالَ: " أَنْ تُؤمِنَ بِالله، وَمَلاِئكَتِه، وَكُتُبِهِ ، وَرُسُلِهِ ، وَالْيَومِ الآَخِر ، وَتُؤْمِنَ بِالقَدَرِ خَيْرِهِ وَشَرِّهِ " قَالَ: صَدَقْتَ، قَالَ فَأخْبِرْنِيْ عَنِ الإِحْسَانِ، قَالَ: " أَنْ تَعْبُدَ اللهَ كَأَنَكَ تَرَاهُ، فَإِنْ لمْ تَكُنْ تَرَاهُ فَإِنَّهُ يَرَاكَ " . قَالَ: فَأَخْبِرْنِي عَنِ السَّاعَةِ ، قَالَ : " مَا الْمَسئُوُلُ عَنْهَا بِأَعْلَمَ مِنَ السَّائِلِ " قَالَ : فَأخْبِرْنِيْ عَنْ أَمَارَاتِها ، قَالَ : " أَنْ تَلِدَ الأَمَةُ رَبَّتَهَا ، وَأَنْ تَرى الحُفَاةَ العُرَاةَ العَالَةَ رِعَاءَ الشَّاءِ يَتَطَاوَلُوْنَ فِي البُنْيَانِ " ثْمَّ انْطَلَقَ فَلَبِثتُ مَلِيَّاً ثُمَّ قَالَ : " يَا عُمَرُ أَتَدْرِي مَنِ السَّائِلُ؟ " قُلْتُ اللهُ وَرَسُوله أَعْلَمُ قَالَ : " فَإِنَّهُ جِبْرِيْلُ أَتَاكُمْ يُعَلَّمُكُمْ دِيْنَكُمْ " .رواه مسلم`
                },

                {
                    number: 3, title: 'أركان الإسلام', narrator: 'أَبِيْ عَبْدِ الرَّحْمَنِ عَبْدِ اللهِ بْنِ عُمَرَ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَبِيْ عَبْدِ الرَّحْمَنِ عَبْدِ اللهِ بْنِ عُمَرَ بْن الخَطَّابِ رَضِيَ اللهُ عَنْهُمَا قَالَ: سَمِعْتُ النبي ﷺ يَقُوْلُ: " بُنِيَ الإِسْلامُ عَلَى خَمْسٍ: شَهَادَةِ أَنْ لاَ إِلَهَ إِلاَّ الله وَأَنَّ مُحَمَّدَاً رَسُوْلُ اللهِ، وَإِقَامِ الصَّلاةِ، وَإِيْتَاءِ الزَّكَاةِ، وَحَجِّ البِيْتِ، وَصَوْمِ رَمَضَانَ "`
                },

                {
                    number: 4, title: 'مراحل الخلق', narrator: 'عَبْدِ اللهِ بنِ مَسْعُوْد', source: 'رواه البخاري ومسلم',
                    text: `عَنْ عَبْدِ اللهِ بنِ مَسْعُوْدْ رَضِيَ اللهُ عَنْهُ قَالَ: حَدَّثَنَا رَسُوْلُ اللهِ ﷺ وَهُوَ الصَّادِقُ المَصْدُوْقُ : " إِنَّ أَحَدَكُمْ يُجْمَعُ خَلْقُهُ فِيْ بَطْنِ أُمِّهِ أَرْبَعِيْنَ يَوْمَاً نُطْفَةً، ثُمَّ يَكُوْنُ عَلَقَةً مِثْلَ ذَلِكَ،ثُمَّ يَكُوْنُ مُضْغَةً مِثْلَ ذَلِكَ،ثُمَّ يُرْسَلُ إِلَيْهِ المَلَكُ فَيَنفُخُ فِيْهِ الرٌّوْحَ،وَيَؤْمَرُ بِأَرْبَعِ كَلِمَاتٍ: بِكَتْبِ رِزْقِهِ وَأَجَلِهِ وَعَمَلِهِ وَشَقِيٌّ أَوْ سَعِيْدٌ. فَوَالله الَّذِي لاَ إِلَهَ غَيْرُهُ إِنََّ أَحَدَكُمْ لَيَعْمَلُ بِعَمَلِ أَهْلِ الجَنَّةِ حَتَّى مَا يَكُوْنُ بَيْنَهُ وَبَيْنَهَا إلاذِرَاعٌ فَيَسْبِقُ عَلَيْهِ الكِتَابُ فَيَعْمَلُ بِعَمَلِ أَهْلِ النَّارِ فَيَدْخُلُهَا، وَإِنَّ أَحَدَكُمْ لَيَعْمَلُ بِعَمَلِ أَهْلِ النَّارِ حَتَّى مَايَكُونُ بَيْنَهُ وَبَيْنَهَا إلا ذِرَاعٌ فَيَسْبِقُ عَلَيْهِ الكِتَابُ فَيَعْمَلُ بِعَمَلِ أَهْلِ الجَنَّةِ فَيَدْخُلُهَا " رواه البخاري ومسلم.`
                },

                {
                    number: 5, title: 'النهي عن الابتداع في الدين', narrator: 'أُمِّ المُؤمِنِينَ أُمِّ عَبْدِ اللهِ عَائِشَةَ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أُمِّ المُؤمِنِينَ أُمِّ عَبْدِ اللهِ عَائِشَةَ - رَضِيَ اللهُ عَنْهَا - قَالَتْ: قَالَ رَسُوْلُ اللهِ : " مَنْ أَحْدَثَ فِيْ أَمْرِنَا هَذَا مَا لَيْسَ مِنْهُ فَهُوَ رَدٌّ " رواه البخاري ومسلم، وفي رواية لمسلم " مَنْ عَمِلَ عَمَلاً لَيْسَ عَلَيْهِ أَمْرُنَا فَهُوَ رَدٌّ "`
                },

                {
                    number: 6, title: 'البعد عن مواطن الشبهات', narrator: 'أَبِيْ عَبْدِ اللهِ النُّعْمَانِ بْنِ بِشِيْر', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَبِيْ عَبْدِ اللهِ النُّعْمَانِ بْنِ بِشِيْر رضي الله عنهما قَالَ: سَمِعْتُ رَسُوْلَ اللهِ ﷺ يَقُوْلُ: (إِنَّ الحَلالَ بَيِّنٌ وَإِنَّ الحَرَامَ بَيِّنٌ وَبَيْنَهُمَا أُمُوْرٌ مُشْتَبِهَات لاَ يَعْلَمُهُنَّ كَثِيْرٌ مِنَ النَّاس،ِ فَمَنِ اتَّقَى الشُّبُهَاتِ فَقَدِ اسْتَبْرأَ لِدِيْنِهِ وعِرْضِه، وَمَنْ وَقَعَ فِي الشُّبُهَاتِ وَقَعَ فِي الحَرَامِ كَالرَّاعِي يَرْعَى حَوْلَ الحِمَى يُوشِكُ أَنْ يَقَعَ فِيْهِ. أَلا وَإِنَّ لِكُلِّ مَلِكٍ حِمَىً . أَلا وَإِنَّ حِمَى اللهِ مَحَارِمُهُ، أَلا وإِنَّ فِي الجَسَدِ مُضْغَةً إِذَا صَلَحَتْ صَلَحَ الجَسَدُ كُلُّهُ وإذَا فَسَدَت فَسَدَ الجَسَدُ كُلُّهُ أَلا وَهيَ القَلْبُ) رواه البخاري ومسلم .`
                },

                {
                    number: 7, title: 'الدين النصيحة', narrator: 'أَبِي رُقَيَّةَ تَمِيْم بْنِ أَوْسٍ الدَّارِيِّ', source: 'رواه مسلم',
                    text: `عَنْ أَبِيْ رُقَيَّةَ تَمِيْم بْنِ أَوْسٍ الدَّارِيِّ رضي الله عنه أَنَّ النبي ﷺ قَالَ:( الدِّيْنُ النَّصِيْحَةُ قُلْنَا: لِمَنْ يَا رَسُولَ اللهِ ؟ قَالَ: للهِ، ولكتابه، ولِرَسُوْلِهِ، وَلأَئِمَّةِ المُسْلِمِيْنَ، وَعَامَّتِهِمْ)رواه مسلم.`
                },

                {
                    number: 8, title: 'حرمة دم المسلم وماله', narrator: 'ابن عمر رضي الله عنهما', source: 'رواه البخاري ومسلم',
                    text: `عَنِ ابْنِ عُمَرَ رَضِيَ اللهُ عَنْهُمَا أَنَّ رَسُوْلَ اللهِ قَالَ: (أُمِرْتُ أَنْ أُقَاتِلَ النَّاسَ حَتَّى يَشْهَدُوا أَنْ لاَ إِلَهَ إِلاَّ اللهُ وَأَنَّ مُحَمَّدَاً رَسُوْلُ اللهِ وَيُقِيْمُوْا الصَّلاةَ وَيُؤْتُوا الزَّكَاةَ فَإِذَا فَعَلُوا ذَلِكَ عَصَمُوا مِنِّي دِمَاءهَمْ وَأَمْوَالَهُمْ إِلاَّ بِحَقِّ الإِسْلامِ وَحِسَابُهُمْ عَلَى اللهِ تَعَالَى) رواه البخاري ومسلم`
                },

                {
                    number: 9, title: 'النهي عن كثرة السؤال والتشدد', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَبِي هُرَيْرَةَ عَبْدِ الرَّحْمَنِ بْنِ صَخْرٍ رَضِيَ الله تَعَالَى عَنْهُ قَالَ: سَمِعْتُ رَسُوْلَ اللهِ ﷺ يَقُوْلُ: (مَا نَهَيْتُكُمْ عَنْهُ فَاجْتَنِبُوهُ وَمَا أَمَرْتُكُمْ بِهِ فأْتُوا مِنْهُ مَا اسْتَطَعْتُمْ؛ فَإِنَّمَا أَهْلَكَ الَّذِيْنَ مِنْ قَبْلِكُمْ كَثْرَةُ مَسَائِلِهِمْ وَاخْتِلافُهُمْ عَلَى أَنْبِيَائِهِمْ) رواه البخاري ومسلم`
                },

                {
                    number: 10, title: 'سبب إجابة الدعاء', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه مسلم',
                    text: `عَنْ أَبِيْ هُرَيْرَةَ رَضِيَ اللهُ تَعَالَى عَنْهُ قَالَ: قَالَ رَسُوْلُ اللهِ : (إِنَّ اللهَ تَعَالَى طَيِّبٌ لاَ يَقْبَلُ إِلاَّ طَيِّبَاً وَإِنَّ اللهَ أَمَرَ المُؤْمِنِيْنَ بِمَا أَمَرَ بِهِ المُرْسَلِيْنَ فَقَالَ : (يَا أَيُّهَا الرُّسُلُ كُلُوا مِنَ الطَّيِّبَاتِ وَاعْمَلُوا صَالِحاً) (المؤمنون: الآية51) ، وَقَالَ: (يَا أَيُّهَا الَّذِينَ آمَنُوا كُلُوا مِنْ طَيِّبَاتِ مَا رَزَقْنَاكُمْ ) (البقرة: الآية172) ثُمَّ ذَكَرَ الرَّجُلَ يُطِيْلُ السَّفَرَ أَشْعَثَ أَغْبَرَ، يَمُدُّ يَدَيْهِ إِلَى السَّمَاء،ِ يَا رَبِّ يَا رَبِّ، وَمَطْعَمُهُ حَرَامٌ ،وَمَشْرَبُهُ حَرَامٌ، وَمَلْبَسُهُ حَرَامٌ، وَغُذِيَ بِالحَرَامِ فَأَنَّى يُسْتَجَابُ لذلك) رواه مسلم.`
                },

                {
                    number: 11, title: 'اترك ما شككت فيه', narrator: 'أَبِي مُحَمَّدٍ الحَسَنِ بنِ عَلِيّ', source: 'رواه الترمذي والنسائي',
                    text: `عَنْ أَبِي مُحَمَّدٍ الحَسَنِ بنِ عَلِيّ بنِ أبِي طالبٍ سِبْطِ رَسُولِ اللهِ ﷺ وَرَيْحَانَتِهِ رَضِيَ اللهُ عَنْهُمَا قَالَ: حَفِظْتَ مِنْ رَسُوْلِ اللهِ ﷺ : (دَعْ مَا يَرِيْبُكَ إِلَى مَا لاَ يَرِيْبُكَ) رواه الترمذي والنسائي وقال الترمذي: حديث حسن صحيح.`
                },

                {
                    number: 12, title: 'الاشتغال بما يفيد', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه الترمذي',
                    text: `عَنْ أَبِيْ هُرَيْرَةَ رَضِيَ اللهُ عَنْهُ قَالَ: قَالَ رَسُوْلُ اللهِ ﷺ : (مِنْ حُسْنِ إِسْلامِ المَرْءِ تَرْكُهُ مَا لاَ يَعْنِيْهِ) حديثٌ حسنٌ، رواه الترمذي وغيره هكذا.`
                },

                {
                    number: 13, title: 'من كمال الإيمان', narrator: 'أَبِيْ حَمْزَة أَنَسِ بنِ مَالِكٍ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَبِيْ حَمْزَة أَنَسِ بنِ مَالِكٍ رَضِيَ اللهُ تَعَالَى عَنْهُ خَادِمِ رَسُوْلِ اللهِ ﷺ عَن النبي ﷺ قَالَ: (لاَ يُؤمِنُ أَحَدُكُمْ حَتَّى يُحِبَّ لأَخِيْهِ مَا يُحِبُّ لِنَفْسِهِ) رواه البخاري ومسلم`
                },

                {
                    number: 14, title: 'متى يهدر دم المسلم؟', narrator: 'ابن مسعود', source: 'رواه البخاري ومسلم',
                    text: `عنِ ابْنِ مَسْعُودٍ رضي الله عنه قَالَ: قَالَ رَسُولُ اللهِ : (لا يَحِلُّ دَمُ امْرِئٍ مُسْلِمٍ إِلاَّ بإِحْدَى ثَلاثٍ: الثَّيِّبُ الزَّانِيْ، وَالنَّفْسُ بِالنَّفْسِ، وَالتَّاركُ لِدِيْنِهِ المُفَارِقُ للجمَاعَةِ) رواه البخاري ومسلم.`
                },

                {
                    number: 15, title: 'اكرام الضيف', narrator: 'أَبِي هُرَيْרَةَ', source: 'رواه البخاري ومسلم',
                    text: `عَن أَبِي هُرَيْرَةَ رضي الله عنه أَنَّ رَسُولَ اللهِ ﷺ قَالَ: (مَنْ كَانَ يُؤمِنُ بِاللهِ وَاليَوْمِ الآخِرِ فَلْيَقُلْ خَيْرَاً أَو لِيَصْمُتْ، وَمَنْ كَانَ يُؤمِنُ بِاللهِ وَاليَومِ الآخِرِ فَلْيُكْرِمْ جَارَهُ، ومَنْ كَانَ يُؤمِنُ بِاللهِ واليَومِ الآخِرِ فَلْيُكْرِمْ ضَيْفَهُ) رواه البخاري ومسلم.`
                },

                {
                    number: 16, title: 'النهي عن الغضب', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه البخاري',
                    text: `عَنْ أَبِي هُرَيْرَةَ رَضِيَ اللهُ عَنْهُ أَنَّ رَجُلاً قَالَ لِلنَّبيِّ ﷺ : أَوصِنِيْ، قَال : (لاَ تَغْضَبْ) . رواه البخاري`
                },

                {
                    number: 17, title: 'الرفق بالحيوان', narrator: 'أَبِي يَعْلَى شَدَّادِ بنِ أَوْسٍ', source: 'رواه مسلم',
                    text: `عَنْ أَبِي يَعْلَى شَدَّادِ بنِ أَوْسٍ رَضِيَ اللهُ تَعَالَى عَنْهُ عَنْ رَسُولِ اللهِ ﷺ قَالَ: (إِنَّ اللهَ كَتَبَ الإِحْسَانَ عَلَى كُلِّ شَيءٍ. فَإِذَا قَتَلْتُمْ فَأَحْسِنُوا القِتْلَةَ، وَإِذَا ذَبَحْتُمْ فَأَحْسِنُوا الذِّبْحَةَ، وَلْيُحِدَّ أَحَدُكُمْ شَفْرَتَهُ، وَلْيُرِحْ ذَبِيْحَتَهُ) رواه مسلم`
                },

                {
                    number: 18, title: 'الخلق الحسن', narrator: 'أَبِي ذَرٍّ جُنْدُبِ بنِ جُنَادَةَ', source: 'رواه الترمذي',
                    text: `عَنْ أَبِيْ ذَرٍّ جُنْدُبِ بنِ جُنَادَةَ وَأَبِي عَبْدِ الرَّحْمَنِ مُعَاذِ بِنِ جَبَلٍ رَضِيَ اللهُ عَنْهُمَا عَنْ رَسُولِ اللهِ ﷺ قَالَ: (اتَّقِ اللهَ حَيْثُمَا كُنْتَ، وَأَتْبِعِ السَّيِّئَةَ الحَسَنَةَ تَمْحُهَا، وَخَالِقِ النَّاسَ بِخُلُقٍ حَسَنٍ ) رواه الترمذي وقال: حديث حسن. وفي بعض النسخ: حسنٌ صحيح.`
                },

                {
                    number: 19, title: 'الإيمان بالقضاء والقدر', narrator: 'أَبِي عَبَّاسٍ عَبْدِ اللهِ بنِ عَبَّاسٍ', source: 'رواه الترمذي',
                    text: `عَنْ أَبِي عَبَّاسٍ عَبْدِ اللهِ بنِ عَبَّاسٍ رضي الله عنهما قَالَ: كُنْتُ خَلْفَ النبي ﷺ يَومَاً فَقَالَ: (يَا غُلاَمُ إِنّي أُعَلِّمُكَ كَلِمَاتٍ : احْفَظِ اللهَ يَحفَظك، احْفَظِ اللهَ تَجِدهُ تُجَاهَكَ، إِذَاَ سَأَلْتَ فَاسْأَلِ اللهَ، وَإِذَاَ اسْتَعَنتَ فَاسْتَعِن بِاللهِ، وَاعْلَم أَنَّ الأُمّة لو اجْتَمَعَت عَلَى أن يَنفَعُوكَ بِشيءٍ لَمْ يَنْفَعُوكَ إِلا بِشيءٍ قَد كَتَبَهُ اللهُ لَك، وإِن اِجْتَمَعوا عَلَى أَنْ يَضُرُّوكَ بِشيءٍ لَمْ يَضروك إلا بشيءٍ قَد كَتَبَهُ اللهُ عَلَيْكَ، رُفعَت الأَقْلامُ، وَجَفّتِ الصُّحُفُ) رواه الترمذي وقال: حديث حسن صحيح - وفي رواية - غير الترمذي: (اِحفظِ اللهَ تَجٍدْهُ أَمَامَكَ، تَعَرَّفْ إلى اللهِ في الرَّخاءِ يَعرِفْكَ في الشّدةِ، وَاعْلَم أن مَا أَخطأكَ لَمْ يَكُن لِيُصيبكَ، وَمَا أَصَابَكَ لَمْ يَكُن لِيُخطِئكَ، وَاعْلَمْ أنَّ النَّصْرَ مَعَ الصَّبْرِ، وَأَنَّ الفَرَجَ مَعَ الكَربِ، وَأَنَّ مَعَ العُسرِ يُسراً)`
                },

                {
                    number: 20, title: 'الحياء من الإيمان', narrator: 'أَبيْ مَسْعُوْدٍ', source: 'رواه البخاري',
                    text: `عَنْ أَبيْ مَسْعُوْدٍ عُقبَة بنِ عَمْرٍو الأَنْصَارِيِّ البَدْرِيِّ رضي الله عنه قَالَ: قَالَ رَسُوْلُ اللهِ ﷺ (إِنَّ مِمَّا أَدرَكَ النَاسُ مِن كَلاَمِ النُّبُوَّةِ الأُولَى إِذا لَم تَستَحْيِ فاصْنَعْ مَا شِئتَ) رواه البخاري.`
                },

                {
                    number: 21, title: 'الاستقامه بالإسلام', narrator: 'أَبيْ عَمْرٍو (قيل: أَبيْ عمْرَةَ) سُفْيَانَ بنِ عَبْدِ اللهِ', source: 'رواه ابن عمرو (المروي عند بعض المرويات)',
                    text: `عَنِ أَبيْ عَمْرٍو، وَقِيْلَ،أَبيْ عمْرَةَ سُفْيَانَ بنِ عَبْدِ اللهِ رضي الله عنه قَالَ: قُلْتُ يَا رَسُوْلَ اللهِ قُلْ لِيْ فِي الإِسْلامِ قَوْلاً لاَ أَسْأَلُ عَنْهُ أَحَدَاً غَيْرَكَ؟ قَالَ: (قُلْ آمَنْتُ باللهِ ثُمَّ استَقِمْ)`
                },

                {
                    number: 22, title: 'الطريق إلى الجنة', narrator: 'أَبيْ عبدِ اللهِ جَابِرِ بنِ عَبْدِ اللهِ الأَنْصَارِيِّ', source: 'رواه مسلم',
                    text: `عَنْ أَبيْ عَبْدِ اللهِ جَابِرِ بنِ عَبْدِ اللهِ الأَنْصَارِيِّ رضي الله عنه أَنَّ رَجُلاً سَأَلَ النبي ﷺ فَقَالَ: (أَرَأَيتَ إِذا صَلَّيْتُ المَكْتُوبَاتِ، وَصُمْتُ رَمَضانَ، وَأَحلَلتُ الحَلاَلَ، وَحَرَّمْتُ الحَرَامَ، وَلَمْ أَزِدْ عَلى ذَلِكَ شَيئاً أَدخُلالجَنَّة ؟ قَالَ: نَعَمْ) رواه مسلم`
                },

                {
                    number: 23, title: 'جوامع الخير', narrator: 'أَبِي مَالِكٍ الحَارِثِ بنِ عَاصِم الأَشْعَرِيِّ', source: 'رواه مسلم',
                    text: `عَنْ أَبِي مَالِكٍ الحَارِثِ بنِ عَاصِم الأَشْعَرِيِّ رَضِيَ اللهُ عَنْهُ قَالَ: قَالَ رَسُولُ اللهِ ﷺ : (الطُّهُورُ شَطْرُ الإِيْمَانِ، والحَمْدُ للهِ تَمْلأُ الميزانَ، وسُبْحَانَ اللهِ والحَمْدُ للهِ تَمْلآنِ - أَو تَمْلأُ - مَا بَيْنَ السَّمَاءِ والأَرْضِ، وَالصَّلاةُ نُورٌ، والصَّدَقَةُ بُرْهَانٌ، وَالصَّبْرُ ضِيَاءٌ، وَالقُرْآنُ حُجَّةٌ لَكَ أَو عَلَيْكَ، كُلُّ النَّاسِ يَغْدُو فَبَائِعٌ نَفْسَهُ فَمُعْتِقُهَا أَو مُوبِقُهَا)رواه مسلم.`
                },

                {
                    number: 24, title: 'من فضل الله على الناس', narrator: 'أَبي ذرّ الغفاري', source: 'رواه مسلم',
                    text: `عَنْ أَبي ذرٍّ الغِفَارْي رضي الله عنه عَن النبي ﷺ فيمَا يَرْويه عَنْ رَبِِّهِ عزَّ وجل أَنَّهُ قَالَ: (يَا عِبَادِيْ إِنِّيْ حَرَّمْتُ الظُّلْمَ عَلَى نَفْسِيْ وَجَعَلْتُهُ بَيْنَكُمْ مُحَرَّمَاً فَلا تَظَالَمُوْا، يَا عِبَادِيْ كُلُّكُمْ ضَالٌّ إِلاَّ مَنْ هَدَيْتُهُ فَاسْتَهْدُوْنِي أَهْدِكُمْ، يَا عِبَادِيْ كُلُّكُمْ جَائِعٌ إِلاَّ مَنْ أَطْعَمْتُهُ فاَسْتَطْعِمُونِي أُطْعِمْكُمْ، يَا عِبَادِيْ كُلُّكُمْ عَارٍ إِلاَّ مَنْ كَسَوْتُهُ فَاسْتَكْسُوْنِيْ أَكْسُكُمْ، يَا عِبَادِيْ إِنَّكُمْ تُخْطِئُوْنَ بِاللَّيْلِ وَالنَّهَارِ وَأَنَا أَغْفِرُ الذُّنُوْبَ جَمِيْعَاً فَاسْتَغْفِرُوْنِيْ أَغْفِرْ لَكُمْ، يَا عِبَادِيْ إِنَّكُمْ لَنْ تَبْلُغُوْا ضَرِّيْ فَتَضُرُّوْنِيْ وَلَنْ تَبْلُغُوْا نَفْعِيْ فَتَنْفَعُوْنِيْ، يَا عِبَادِيْ لَوْ أَنَّ أَوَّلَكُمْ وَآخِرَكُمْ وَإِنْسَكُمْ وَجِنَّكُمْ كَانُوْا عَلَى أَتْقَى قَلْبِ رَجُلٍ وَاحِدٍ مِنْكُمْ مَا زَادَ ذَلِكَ فَيْ مُلْكِيْ شَيْئَاً. يَا عِبَادِيْ لَوْ أَنَّ أَوَّلَكُمْ وَآخِرَكُمْ وَإِنْسَكُمْ وَجِنَّكُمْ كَانُوْا عَلَى أَفْجَرِ قَلْبِ رَجُلٍ وَاحِدٍ مِنْكُمْ مَا نَقَصَ ذَلِكَ مِنْ مُلْكِيْ شَيْئَاً، يَا عِبَادِيْ لَوْ أنَّ أَوَّلَكُمْ وَآخِرَكُمْ وَإنْسَكُمْ وَجِنَّكُمْ قَامُوْا فِيْ صَعِيْدٍ وَاحِدٍ فَسَأَلُوْنِيْ فَأَعْطَيْتُ كُلَّ وَاحِدٍ مَسْأَلَتَهُ مَا نَقَصَ ذَلِكَ مِمَّا عِنْدِيْ إِلاَّ كَمَا يَنْقُصُ المِخْيَطُ إَذَا أُدْخِلَ البَحْرَ، يَا عِبَادِيْ إِنَّمَا هِيَ أَعْمَالُكُمْ أُحْصِيْهَا لَكُمْ ثُمَّ أُوَفِّيْكُمْ إِيَّاهَا فَمَنْ وَجَدَ خَيْرَاً فَليَحْمَدِ اللهَ وَمَنْ وَجَدَ غَيْرَ ذَلِكَ فَلاَ يَلُوْمَنَّ إِلاَّ نَفْسَهُ) رواه مسلم.`
                },

                {
                    number: 25, title: 'فضل الذكر', narrator: 'أَبي ذرّ', source: 'رواه مسلم',
                    text: `عَنْ أَبي ذَرٍّ رضي الله عنه قال: أَنَّ أُنَاسَاً مِنْ أَصحَابِ رَسُولِ اللهِ ﷺ قَالوا للنَّبي ﷺ يَارَسُولَ الله: ذَهَبَ أَهلُ الدثورِ بِالأُجورِ، يُصَلُّوْنَ كَمَا نُصَلِّيْ، وَيَصُوْمُوْنَ كَمَا نَصُوْمُ، وَيَتَصَدَّقُوْنَ بفُضُوْلِ أَمْوَالِهِمْ، قَالَ: (أَوَ لَيْسَ قَدْ جَعَلَ اللهُ لَكُمْ مَا تَصَّدَّقُوْنَ؟ إِنَّ بِكُلِّ تَسْبِيْحَةٍ صَدَقَة.وَكُلِّ تَكْبِيْرَةٍ صَدَقَةً وَكُلِّ تَحْمَيْدَةٍ صَدَقَةً وَكُلِّ تَهْلِيْلَةٍ صَدَقَةٌ وَأَمْرٌ بالِمَعْرُوْفٍ صَدَقَةٌ وَنَهْيٌ عَنْ مُنْكَرٍ صَدَقَةٌ وَفِيْ بُضْعِ أَحَدِكُمْ صَدَقَةٌ قَالُوا: يَا رَسُوْلَ اللهِ أَيَأْتِيْ أَحَدُنَا شَهْوَتَهُ وَيَكُوْنُ لَهُ فِيْهَا أَجْرٌ؟ قَالَ:أَرَأَيْتُمْ لَوْ وَضَعَهَا فَيْ حَرَامٍ أَكَانَ عَلَيْهِ وِزْرٌ؟ فَكَذَلِكَ إِذَا وَضَعَهَا فَي الحَلالِ كَانَ لَهُ أَجْرٌ) رَوَاهُ مُسْلِمٌ`
                },

                {
                    number: 26, title: 'كثرة طرق الخير', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه البخاري ومسلم',
                    text: `عَنْ أَبِي هُرَيْرَةَ رضي الله عنه قَالَ: قَالَ رَسُولُ اللهِ ﷺ : (كُلُّ سُلامَى مِنَ النَّاسِ عَلَيْهِ صَدَقَةٌ كُلُّ يَومٍ تَطْلُعُ فِيْهِ الشَّمْسُ: تَعْدِلُ بَيْنَ اثْنَيْنِ صَدَقَةٌ، وَتُعِيْنُ الرَّجُلَ في دَابَّتِهِ فَتَحْمِلُ لَهُ عَلَيْهَا أَو تَرْفَعُ لَهُ عَلَيْهَا مَتَاعَهُ صَدَقَةٌ، وَالكَلِمَةُ الطَّيِّبَةُ صَدَقَةٌ، وَبِكُلِّ خُطْوَةٍ تَمْشِيْهَا إِلَى الصَّلاةِ صَدَقَةٌ، وَتُمِيْطُ الأَذى عَنِ الطَّرِيْقِ صَدَقَةٌ) رواه البخاري ومسلم.`
                },

                {
                    number: 27, title: 'تعريف البر والإثم', narrator: 'النواس بن سمعان (وعادة مذكور مع رواية وأَبصة بن معبد)', source: 'رواه مسلم',
                    text: `عن النواس بن سمعان رضي الله عنهما ، عن النبي ﷺ قال: (البر حسن الخلق ، والإثم ما حاك في نفسك وكرهت أن يطلع عليه الناس ) .رواه مسلم.وعن وابصة بن معبد رضى الله عنه ، قال : أتيت رسول الله ﷺ ، فقال : (جئت تسأل عن البر و الإثم ؟) قلت : نعم ؛ قال : (استفت قلبك ؛ البر ما اطمأنت إليه النفس واطمأن اليه القلب ، والإثم ما حاك في النفس وتردد في الصدر ، وإن أفتاك الناس وأفتوك) .حديث حسن`
                },

                {
                    number: 28, title: 'السمع والطاعة', narrator: 'أَبي نَجِيحٍ العربَاضِ بنِ سَاريَةَ', source: 'رواه أبو داود والترمذي',
                    text: `عَن أَبي نَجِيحٍ العربَاضِ بنِ سَاريَةَ رضي الله عنه قَالَ: وَعَظَنا رَسُولُ اللهِ مَوعِظَةً وَجِلَت مِنهَا القُلُوبُ وَذَرَفَت مِنهَا العُيون. فَقُلْنَا: يَارَسُولَ اللهِ كَأَنَّهَا مَوْعِظَةُ مُوَدِّعٍ فَأَوصِنَا، قَالَ: (أُوْصِيْكُمْ بِتَقْوَى اللهِ عز وجل وَالسَّمعِ وَالطَّاعَةِ وَإِنْ تَأَمَّرَ عَلَيْكُمْ عَبْدٌ، فَإِنَّهُ مَنْ يَعِشْ مِنْكُمْ فَسَيَرَى اخْتِلافَاً كَثِيرَاً؛ فَعَلَيكُمْ بِسُنَّتِيْ وَسُنَّةِ الخُلَفَاءِ الرَّاشِدِينَ المّهْدِيِّينَ عَضُّوا عَلَيْهَا بِالنَّوَاجِذِ وَإِيَّاكُمْ وَمُحْدَثَاتِ الأُمُورِ فإنَّ كلّ مُحدثةٍ بدعة، وكُلَّ بِدْعَةٍ ضَلالَةٌ) رواه أبو داود والترمذي وقال : حديث حسن صحيح.`
                },

                {
                    number: 29, title: 'بواب الخير', narrator: 'مُعَاذ بن جَبَل', source: 'رواه الترمذي',
                    text: `عَن مُعَاذ بن جَبَلٍ رضي الله عنه قَالَ: قُلتُ يَا رَسُولَ الله أَخبِرنِي بِعَمَلٍٍ يُدخِلُني الجَنَّةَ وَيُبَاعدني منٍ النار قَالَ: (لَقَدْ سَأَلْتَ عَنْ عَظِيْمٍ وَإِنَّهُ لَيَسِيْرٌ عَلَى مَنْ يَسَّرَهُ اللهُ تَعَالَى عَلَيْهِ: تَعْبُدُ اللهَ لاَتُشْرِكُ بِهِ شَيْئَا، وَتُقِيْمُ الصَّلاة، وَتُؤتِي الزَّكَاة، وَتَصُومُ رَمَضَانَ، وَتَحُجُّ البَيْتَ. ثُمَّ قَالَ: أَلاَ أَدُلُّكَ عَلَى أَبْوَابِ الخَيْرِ: الصَّوْمُ جُنَّةٌ، وَالصَّدَقَةُ تُطْفِئُ الخَطِيْئَةَ كَمَا يُطْفِئُ المَاءُ النَّارَ، وَصَلاةُ الرَّجُلِ فِي جَوْفِ اللَّيْلِ ثُمَّ تَلا : (تَتَجَافَى جُنُوبُهُمْ عَنِ الْمَضَاجِعِ) حَتَّى بَلَغَ: (يَعْلَمُونْ) [السجدة:16-17] ثُمَّ قَالَ: أَلا أُخْبِرُكَ بِرَأْسِ الأَمْرِ وَعَمُودِهِ وَذِرْوَةِ سَنَامِهِ ؟ قُلْتُ: بَلَى يَارَسُولَ اللهِ، قَالَ: رَأْسُ الأَمْرِ الإِسْلامُ وَعَمُودُهُ الصَّلاةُ وَذروَةُ سَنَامِهِ الجِهَادُ ثُمَّ قَالَ: أَلا أُخبِرُكَ بِملاكِ ذَلِكَ كُلِّهِ ؟ قُلْتُ:بَلَى يَارَسُولَ اللهِ. فَأَخَذَ بِلِسَانِهِ وَقَالَ: كُفَّ عَلَيْكَ هَذَا. قُلْتُ يَانَبِيَّ اللهِ وَإِنَّا لَمُؤَاخَذُونَ بِمَا نَتَكَلَّمُ بِهِ ؟ فَقَالَ: ثَكِلَتْكَ أُمُّكَ يَامُعَاذُ. وَهَلْ يَكُبُّ النَّاسَ فِي النَّارِ عَلَى وُجُوهِهِمْ أَو قَالَ: عَلَى مَنَاخِرِهِمْ إِلاَّ حَصَائِدُ أَلسِنَتِهِمْ) رواه الترمذي وقال: حديث حسن صحيح.`
                },

                {
                    number: 30, title: 'الوقوف عند حدود الشرع', narrator: 'أَبِيْ ثَعْلَبَةَ الخُشَنِيِّ جُرثُومِ بنِ نَاشِرٍ', source: 'رواه الدارقطني وغيره',
                    text: `عَنْ أَبِيْ ثَعْلَبَةَ الخُشَنِيِّ جُرثُومِ بنِ نَاشِرٍ رضي الله عنه عَن رَسُولِ اللهِ ﷺ قَالَ: (إِنَّ اللهَ فَرَضَ فَرَائِضَ فَلا تُضَيِّعُوهَا، وَحَدَّ حُدُودَاً فَلا تَعْتَدُوهَا وَحَرَّمَ أَشْيَاءَ فَلا تَنْتَهِكُوهَا، وَسَكَتَ عَنْ أَشْيَاءَ رَحْمَةً لَكُمْ غَيْرَ نِسْيَانٍ فَلا تَبْحَثُوا عَنْهَا) حديث حسن رواه الدارقطني وغيره.`
                },

                {
                    number: 31, title: 'الزهد في الدنيا', narrator: 'أَبي العَبّاس سَعدِ بنِ سَهلٍ السَّاعِدي', source: 'رواه ابن ماجه وغيره',
                    text: `عَنْ أَبي العَباس سَعدِ بنِ سَهلٍ السَّاعِدي رضي الله عنه قَالَ: جَاءَ رَجُلٌ إِلَى النبي ﷺ فَقَالَ: يَا رَسُول الله: دُلَّني عَلَى عَمَلٍ إِذَا عَمَلتُهُ أَحَبَّني اللهُ، وَأَحبَّني النَاسُ ؟ فَقَالَ: (ازهَد في الدُّنيَا يُحِبَّكَ اللهُ ، وازهَد فيمَا عِندَ النَّاسِ يُحِبَّكَ النَّاسُ) حديث حسن رواه ابن ماجة وغيره بأسانيد حسنة.`
                },

                {
                    number: 32, title: 'لا ضرر ولا ضرار', narrator: 'أَبُو سَعِيدْ سَعْد بن مالك الخدري', source: 'رواه ابن ماجه والدارقطني',
                    text: `عن أبي سعيد سعد بن مالك بن سنان الخدري رضي الله عنه أن رسول الله ( ﷺ ) قال: (لا ضرر ولا ضرار) . حديث حسن رواه ابن ماجه والدار قطني وغيرهما مسنداً`
                },

                {
                    number: 33, title: 'البيّنة على المُدَّعي', narrator: 'ابن عباس', source: 'رواه البيهقي',
                    text: `عنِ ابْنِ عَبَّاسٍ رَضِيَ اللهُ عَنْهُمَا أَنَّ رَسُولَ اللهِ ﷺ قَالَ: "لَوْ يُعْطَى النَّاسُ بِدعوَاهُمْ لادَّعَى رِجَالٌ أَمْوَال قَومٍ وَدِمَاءهُمْ، وَلَكِنِ البَينَةُ عَلَى المُدَّعِي، وَاليَمينُ عَلَى مَن أَنكَر" حديث حسن رواه البيهقي هكذا بعضه في الصحيحين.`
                },

                {
                    number: 34, title: 'تغيير المنكر فريضة', narrator: 'أَبِي سَعيدٍ الخُدريّ', source: 'رواه مسلم',
                    text: `عَنْ أَبي سَعيدٍ الخُدريِّ رضي الله عنه قَالَ: سَمِعتُ رِسُولَ اللهِ ﷺ يَقولُ: (مَن رَأى مِنكُم مُنكَرَاً فَليُغَيِّرْهُ بِيَدِهِ، فَإِنْ لَمْ يَستَطعْ فَبِلِسَانِهِ، فَإِنْ لَمْ يَستَطعْ فَبِقَلبِه وَذَلِكَ أَضْعَفُ الإيمَانِ) رواه مسلم.`
                },

                {
                    number: 35, title: 'المسلم أخو المسلم', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه مسلم',
                    text: `عَنْ أَبي هُرَيرَةَ رضي الله عنه قَالَ: قَالَ رَسُولُ اللهِ ﷺ : (لاَ تَحَاسَدوا، وَلاَتَنَاجَشوا، وَلاَ تَبَاغَضوا، وَلاَ تَدَابَروا، وَلاَ يَبِع بَعضُكُم عَلَى بَيعِ بَعضٍ، وَكونوا عِبَادَ اللهِ إِخوَانَاً، المُسلِمُ أَخو المُسلم، لاَ يَظلِمهُ، وَلاَ يَخذُلُهُ، وَلا يكْذِبُهُ، وَلايَحْقِرُهُ، التَّقوَى هَاهُنَا - وَيُشيرُ إِلَى صَدرِهِ ثَلاَثَ مَراتٍ - بِحَسْبِ امرىء مِن الشَّرأَن يَحْقِرَ أَخَاهُ المُسلِمَ، كُلُّ المُسِلمِ عَلَى المُسلِمِ حَرَام دَمُهُ وَمَالُه وَعِرضُه) رواه مسلم`
                },

                {
                    number: 36, title: 'قضاء حوائج المسلمين', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه مسلم',
                    text: `عَنْ أَبي هُرَيرَة رضي الله عنه عَنِ النبي ﷺ قَالَ: (مَنْ نَفَّسَ عَنْ مُؤمِن كُربَةً مِن كُرَبِ الدُّنيَا نَفَّسَ اللهُ عَنهُ كُربَةً مِنْ كرَبِ يَوم القيامَةِ، وَمَنْ يَسَّرَ على مُعسرٍ يَسَّرَ الله عَلَيهِ في الدُّنيَا والآخِرَة، وَمَنْ سَتَرَ مُسلِمَاً سَتَرَهُ الله في الدُّنيَا وَالآخِرَة، وَاللهُ في عَونِ العَبدِ مَا كَانَ العَبدُ في عَونِ أخيهِ، وَمَنْ سَلَكَ طَريقَاً يَلتَمِسُ فيهِ عِلمَاً سَهَّلَ اللهُ لهُ بِهِ طَريقَاً إِلَى الجَنَّةِ، وَمَا اجتَمَعَ قَومٌ في بَيتٍ مِنْ بيوتِ اللهِ يَتلونَ كِتابِ اللهِ وَيتَدارَسونهَ بَينَهُم إِلا نَزَلَت عَلَيهُم السَّكينَة وَغَشيَتهم الرَّحمَة وحَفَتهُمُ المَلائِكة وَذَكَرهُم اللهُ فيمَن عِندَهُ،وَمَنْ بَطَّأ بِهِ عَمَلُهُ لَمْ يُسْرِعْ بهِ نَسَبُهُ)رواه مسلم بهذا اللفظ`
                },

                {
                    number: 37, title: 'الترغيب في فعل الحسنات', narrator: 'ابن عباس', source: 'رواه البخاري ومسلم',
                    text: `عَن ابْنِ عَبَّاسٍ رَضِيَ اللهُ عَنْهُمَا عَنِ النبي ﷺ فِيْمَا يَرْوِيْهِ عَنْ رَبِّهِ تَبَارَكَ وَتَعَالى أَنَّهُ قَالَ: (إِنَّ الله كَتَبَ الحَسَنَاتِ وَالسَّيئَاتِ ثُمَّ بَيَّنَ ذَلِكَ؛ فَمَنْ هَمَّ بِحَسَنَةٍ فَلَمْ يَعْمَلْهَا كَتَبَهَا اللهُ عِنْدَهُ حَسَنَةً كَامِلَةً،وَإِنْ هَمَّ بِهَا فَعَمِلَهَا كَتَبَهَا اللهُ عِنْدَهُ عَشْرَ حَسَنَاتٍ إِلَى سَبْعِمائَةِ ضِعْفٍ إِلىَ أَضْعَاف كَثِيْرَةٍ. وَإِنْ هَمَّ بِسَيِّئَةٍ فَلَمْ يَعْمَلْهَا كَتَبَهَا اللهُ عِنْدَهُ حَسَنَةً كَامِلَةً،وَإِنْ هَمَّ بِهَا فَعَمِلَهَا كَتَبَهَا اللهُ سَيِّئَةً وَاحِدَةً) رَوَاهُ البُخَارِيُّ وَمُسْلِمٌ في صَحِيْحَيهِمَا بِهَذِهِ الحُرُوْفِ.`
                },

                {
                    number: 38, title: 'جزاء معادات الأولياء', narrator: 'أَبِي هُرَيْرَةَ', source: 'رواه البخاري',
                    text: `عَنْ أَبِي هُرَيْرَةَ رضي الله عنه قَالَ: قَالَ رَسُولُ اللهِ ﷺ : (إِنَّ اللهَ تَعَالَى قَالَ: مَنْ عَادَى لِي وَلِيَّاً فَقَدْ آذَنْتُهُ بِالحَرْبِ. وَمَا تَقَرَّبَ إِلِيَّ عَبْدِيْ بِشَيءٍ أَحَبَّ إِلِيَّ مِمَّا افْتَرَضْتُهُ عَلَيْهِ. ولايَزَالُ عَبْدِيْ يَتَقَرَّبُ إِلَيَّ بِالنَّوَافِلِ حَتَّى أُحِبَّهُ، فَإِذَا أَحْبَبتُهُ كُنْتُ سَمْعَهُ الَّذِيْ يَسْمَعُ بِهِ، وَبَصَرَهُ الَّذِيْ يُبْصِرُ بِهِ، وَيَدَهُ الَّتِي يَبْطِشُ بِهَا، وَرِجْلَهُ الَّتِي يَمْشِيْ بِهَا. وَلَئِنْ سَأَلَنِيْ لأُعطِيَنَّهُ، وَلَئِنْ اسْتَعَاذَنِيْ لأُعِيْذَنَّهُ) رواه البخاري`
                },

                {
                    number: 39, title: 'التجاوز عن الخطأ والنسيان', narrator: 'ابن عباس', source: 'رواه ابن ماجه والبيهقي',
                    text: `عَنِ ابْنِ عَبَّاسٍ رَضِيَ اللهُ عَنْهُمَا أَنَّ رَسُولَ اللهِ ﷺ قَال: (إِنَّ اللهَ تَجَاوَزَ لِي عَنْ أُمَّتِي الخَطَأَ وَالنِّسْيَانَ وَمَا اسْتُكْرِهُوا عَلَيْهِ) حديث حسن رواه ابن ماجه والبيهقي وغيرهما.`
                },

                {
                    number: 40, title: 'كن في الدنيا كأنك غريب', narrator: 'ابن عمر', source: 'رواه البخاري',
                    text: `عَنِ ابْنِ عُمَرَ رَضِيَ اللهُ عَنْهُمَا قَالَ: أَخَذَ رَسُولُ اللهِ ﷺ بِمنْكبيَّ فَقَالَ: (كُنْ فِي الدُّنْيَا كَأَنَّكَ غَرِيْبٌ أَوْ عَابِرُ سَبِيْلٍ) وَكَانَ ابْنُ عُمَرَ رَضِيَ اللهُ عَنْهُمَا يَقُوْلُ: إِذَا أَمْسَيْتَ فَلا تَنْتَظِرِ الصَّبَاحَ، وَإِذَا أَصْبَحْتَ فَلا تَنْتَظِرِ المَسَاءَ. وَخُذْ مِنْ صِحَّتِكَ لِمَرَضِكَ، وَمِنْ حَيَاتِكَ لمَوْتِكَ..رواه البخاري.`
                }

            ];

        const defaultMap = new Map(hadithData.map(i => [i.number, i]));
        const defaultHadiths = Array.from({ length: 40 }, (_, i) => {
            const num = i + 1; const def = defaultMap.get(num) || {};
            return { number: num, title: def.title || titles[num] || `الحديث ${num}`, narrator: def.narrator || '—', source: def.source || '—', text: def.text || `نص الحديث رقم ${num} لم يُدخل بعد.` };
        });

        window.defaultHadiths = defaultHadiths;

        const STORAGE_KEY = 'arbain_hadiths_v1';
        const VIEW_KEY = 'arbain_hadiths_view_v1';

        function debug(msg) { console.log('[arbain-debug]', msg); document.getElementById('debugStatus').textContent = String(msg); }

        (function handleResetQuery() {
            try {
                const p = new URL(location.href).searchParams;
                if (p.get('reset') === '1') {
                    localStorage.removeItem(STORAGE_KEY);
                    localStorage.removeItem(VIEW_KEY);
                    debug('تمت إعادة تهيئة التخزين عبر ?reset=1 — أعد تحميل الصفحة');
                }
            } catch (e) { }
        })();

        function loadHadiths() {
            try {
                const raw = localStorage.getItem(STORAGE_KEY);
                if (raw) {
                    const parsed = JSON.parse(raw);
                    const MIN_TEXT_LEN = 20; 
                    const valid = Array.isArray(parsed) &&
                        parsed.length === 40 &&
                        parsed.every(p => p && typeof p.text === 'string' && p.text.trim().length > MIN_TEXT_LEN);
                    if (valid) {
                        debug('تم تحميل الأحاديث من localStorage (صالح)');
                        return parsed;
                    }

                    debug('المخزن موجود لكنه غير صالح/ناقص — سيتم إصلاحه باستخدام النسخة الافتراضية');
                    const parsedMap = new Map(Array.isArray(parsed) ? parsed.map(x => [x.number, x]) : []);
                    const repaired = defaultHadiths.map(d => {
                        const p = parsedMap.get(d.number) || {};
                        const pText = (p && typeof p.text === 'string') ? p.text.trim() : '';
                        const useText = (pText.length > MIN_TEXT_LEN) ? p.text : d.text;
                        return {
                            number: d.number,
                            title: (p && p.title) || d.title || `الحديث ${d.number}`,
                            narrator: (p && p.narrator) || d.narrator || '—',
                            source: (p && p.source) || d.source || '—',
                            text: useText
                        };
                    });
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(repaired));
                    debug('تمت كتابة نسخة مُصلَحة إلى localStorage');
                    return repaired;
                } else {
                    debug('لا يوجد مخزن سابق، استخدام الافتراضي وكتابة localStorage');
                }
            } catch (err) {
                console.warn('خطأ قراءة/تحليل localStorage:', err);
                debug('خطأ بقراءة localStorage (انظر Console)');
            }

            localStorage.setItem(STORAGE_KEY, JSON.stringify(defaultHadiths));
            debug('تم إنشاء القيم الافتراضية في localStorage');
            return defaultHadiths.slice();
        }

        let hadiths = loadHadiths();
        let current = null;
        let mode = localStorage.getItem(VIEW_KEY) || 'sections';

        const hadithListEl = document.getElementById('hadithList');
        const searchEl = document.getElementById('search');
        const btnSections = document.getElementById('modeSections');
        const btnFlat = document.getElementById('modeFlat');

        function setMode(m) { mode = m; localStorage.setItem(VIEW_KEY, m); updateModeUI(); render(); }
        function updateModeUI() { btnSections.classList.toggle('active', mode === 'sections'); btnFlat.classList.toggle('active', mode === 'flat'); }

        btnSections.addEventListener('click', () => setMode('sections'));
        btnFlat.addEventListener('click', () => setMode('flat'));

        function escapeHtml(str) { if (!str) return ''; return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'); }
        function safeHighlight(text) {
            let s = escapeHtml(text || '');
            s = s.replace(/"([^"]+)"/g, '<span class="double-quote">"$1"</span>');
            s = s.replace(/\(([^)]+)\)/g, '<span class="paren">($1)</span>');
            s = s.replace(/\r\n|\n|\r/g, '<br>');
            return s;
        }

            function cleanText(input) {
                if (!input || typeof input !== 'string') return input || '';
                let s = input.replace(/\s*(?:\.\.\.|…){1,}\s*(?=\()/g, ' ');
                s = s.replace(/\r\n|\r/g, '\n');
                s = s.split('\n').map(line => line.replace(/\s+/g, ' ').trim()).join('\n');
                return s.trim();
            }


        function render() {
            if (searchEl.value.trim()) { renderSearchResults(searchEl.value.trim()); return; }
            if (mode === 'flat') renderFlatList(); else renderSections();
        }

        function renderSearchResults(q) {
            hadithListEl.innerHTML = '';
            const matches = hadiths.filter(h => String(h.number) === q || (h.title || '').includes(q) || (h.text || '').includes(q) || (h.narrator || '').includes(q));
            if (matches.length === 0) { hadithListEl.innerHTML = '<div class="note">لا توجد نتائج للبحث</div>'; return; }
            matches.forEach(h => {
                const item = document.createElement('div'); item.className = 'hadith-item';
                const btn = document.createElement('button');
                btn.innerHTML = `<div style="display:flex;justify-content:flex-end;align-items:center;gap:8px"><div style="text-align:right"><strong>${escapeHtml(h.title)}</strong><div style="font-size:12px;color:var(--muted)">${escapeHtml(h.narrator)}</div></div><div class="num">${h.number}</div></div>`;
                btn.onclick = () => openHadith(h.number);
                item.appendChild(btn); hadithListEl.appendChild(item);
            });
        }

        function renderSections() {
            hadithListEl.innerHTML = '';
            categories.forEach(sec => {
                const secEl = document.createElement('div'); secEl.className = 'section';
                const header = document.createElement('div'); header.className = 'section-header';
                header.innerHTML = `<strong>${escapeHtml(sec.title)}</strong><span>▶</span>`;
                const body = document.createElement('div'); body.className = 'section-body';
                sec.items.forEach(num => {
                    const h = hadiths.find(x => x.number === num);
                    if (!h) return;
                    const item = document.createElement('div'); item.className = 'hadith-item';
                    const btn = document.createElement('button');
                    btn.innerHTML = `<div style="display:flex;justify-content:flex-end;align-items:center;gap:8px"><div style="text-align:right"><strong>${escapeHtml(h.title)}</strong><div style="font-size:12px;color:var(--muted)">${escapeHtml(h.narrator)}</div></div><div class="num">${h.number}</div></div>`;
                    btn.onclick = () => openHadith(h.number);
                    item.appendChild(btn); body.appendChild(item);
                });
                header.addEventListener('click', () => { const visible = body.style.display === 'block'; body.style.display = visible ? 'none' : 'block'; header.querySelector('span').textContent = visible ? '▶' : '▼'; });
                secEl.appendChild(header); secEl.appendChild(body); hadithListEl.appendChild(secEl);
            });

            const mentioned = new Set(categories.flatMap(s => s.items));
            const others = hadiths.filter(h => !mentioned.has(h.number));
            if (others.length) {
                const secEl = document.createElement('div'); secEl.className = 'section';
                const header = document.createElement('div'); header.className = 'section-header'; header.innerHTML = `<strong>أحاديث غير مصنفة</strong><span>▶</span>`;
                const body = document.createElement('div'); body.className = 'section-body';
                others.forEach(h => {
                    const item = document.createElement('div'); item.className = 'hadith-item';
                    const btn = document.createElement('button');
                    btn.innerHTML = `<div style="display:flex;justify-content:flex-end;align-items:center;gap:8px"><div style="text-align:right"><strong>${escapeHtml(h.title)}</strong><div style="font-size:12px;color:var(--muted)">${escapeHtml(h.narrator)}</div></div><div class="num">${h.number}</div></div>`;
                    btn.onclick = () => openHadith(h.number);
                    item.appendChild(btn); body.appendChild(item);
                });
                header.addEventListener('click', () => { const visible = body.style.display === 'block'; body.style.display = visible ? 'none' : 'block'; header.querySelector('span').textContent = visible ? '▶' : '▼'; });
                secEl.appendChild(header); secEl.appendChild(body); hadithListEl.appendChild(secEl);
            }
        }

        function renderFlatList() {
            hadithListEl.innerHTML = '';
            hadiths.slice().sort((a, b) => a.number - b.number).forEach(h => {
                const item = document.createElement('div'); item.className = 'hadith-item';
                const btn = document.createElement('button');
                btn.innerHTML = `<div style="display:flex;justify-content:flex-end;align-items:center;gap:8px"><div style="text-align:right"><strong>${escapeHtml(h.title)}</strong><div style="font-size:12px;color:var(--muted)">${escapeHtml(h.narrator)}</div></div><div class="num">${h.number}</div></div>`;
                btn.onclick = () => openHadith(h.number);
                item.appendChild(btn); hadithListEl.appendChild(item);
            });
        }

        function openHadith(num) {
            const h = hadiths.find(x => x.number === num);
            if (!h) return;
            current = h;
            document.getElementById('emptyView').style.display = 'none';
            document.getElementById('hadithView').style.display = 'block';
            document.getElementById('hadithTitle').textContent = h.title || `الحديث ${num}`;
            document.getElementById('hadithNumber').textContent = h.number;
            document.getElementById('hadithNarrator').textContent = h.narrator || '-';
            document.getElementById('hadithSource').textContent = h.source || '-';
            document.getElementById('hadithText').innerHTML = safeHighlight(h.text || '-');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('clearBtn').addEventListener('click', () => {
            document.getElementById('emptyView').style.display = 'block';
            document.getElementById('hadithView').style.display = 'none';
            current = null;
        });

        /* استيراد / تصدير */
        document.getElementById('exportBtn').addEventListener('click', () => {
            const blob = new Blob([JSON.stringify(hadiths, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'hadiths.json'; a.click(); URL.revokeObjectURL(url);
        });

        document.getElementById('importBtn').addEventListener('click', () => document.getElementById('fileInput').click());
        document.getElementById('fileInput').addEventListener('change', (e) => {
            const file = e.target.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = () => {
                try {
                    const arr = JSON.parse(reader.result);
                    if (!Array.isArray(arr)) { alert('الملف لا يحتوي على مصفوفة من الأحاديث'); return; }

                    const MIN_TEXT_LEN = 20;
                    const badCount = arr.reduce((c, x) => c + ((x && typeof x.text === 'string' && x.text.trim().length > MIN_TEXT_LEN) ? 0 : 1), 0);
                    if (badCount > 0) {
                        const proceed = confirm(`الملف يحتوي ${badCount} أحاديث بنصوص قصيرة أو ناقصة. هل تريد الاستمرار واستيرادها؟ (إلغاء يوقف الاستيراد)`);
                        if (!proceed) {
                            e.target.value = '';
                            return;
                        }
                    }

                    const parsedMap = new Map(arr.map(x => [x.number, x]));
                    hadiths = Array.from({ length: 40 }, (_, i) => {
                        const num = i + 1; const p = parsedMap.get(num); const d = defaultHadiths[num - 1];
                        const textCandidate = (p && typeof p.text === 'string' && p.text.trim().length > MIN_TEXT_LEN) ? p.text : (d && d.text) || `نص الحديث ${num} لم يُدخل بعد.`;
                        return { number: num, title: (p && p.title) || d.title || titles[num] || `الحديث ${num}`, narrator: (p && p.narrator) || d.narrator || '—', source: (p && p.source) || d.source || '—', text: textCandidate };
                    });
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(hadiths));
                    render();
                    alert('تم استيراد الأحاديث');
                } catch (err) {
                    alert('خطأ بقراءة الملف: ' + err.message);
                }
            };
            reader.readAsText(file, 'utf-8');
            e.target.value = '';
        });

        document.getElementById('resetStorageBtn').addEventListener('click', () => {
            if (!confirm('هل تريد مسح البيانات المخزنة وإعادة تحميل القيم الافتراضية؟')) return;
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem(VIEW_KEY);
            location.reload();
        });

        searchEl.addEventListener('input', () => render());
        updateModeUI();
        console.log('hadithData length =', hadithData.length, 'defaultHadiths length =', defaultHadiths.length);
        console.log('initial hadiths (from storage or default) sample:', hadiths ? hadiths.slice(0, 3) : 'not ready');

        render();
    </script>
</body>


</html>

